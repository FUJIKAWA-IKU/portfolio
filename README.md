# 日々是鍛錬 (にちにちこれたんれん)

## はじめに
予めゲストユーザーを作成していますので是非こちらでも使ってみてください  
email : guest@example<span>.com</span>  
password : guest  

## なぜ作ったか  
　私は現在スポーツジムで受付業務を行っています。業務を通して、自分の想像より多くのご年配のお客様がスポーツジムを足繁くご利用いただいていることに驚きました。そのことについて社員の方と話すと、社員の方から「**歳を重ねてできないことが増えると、何かできるようになることに対してより大きな喜びを感じる**」と聞きました。  
　高齢化社会が進み、身体的・精神的機能の向上が期待できる運動は今後ますます重要視され、その結果、幅広い年齢層の人々が運動を楽しく続けられるためのサービスの需要が高まることが予想されます。そのような社会的背景も含め、私は**幅広い世代の人々に運動することの楽しさを知ってもらい、できなかったことができるようになる喜びを感じてほしい**と思い、本サービスを作成しました。  


## 機能一覧
日々の運動習慣を記録できるアプリで、機能は大きく分けて五つあります。

1. 運動した時間や走行距離などをグラフとして描画できる機能
2. CRUD機能を持つつぶやき投稿機能（つぶやきの新規作成、編集、削除、一覧表示）
3. つぶやき投稿に対するいいね機能
4. つぶやき投稿に対するコメント機能
5. フォロー・フォロワー機能


## 使い方
マイページ中央にある左二つのアイコンから、それぞれランニングあるいは筋トレの運動記録を入力できます  
Runnningアイコン：走行時間・走行距離を記録できます  
Workoutアイコン：筋トレした時間・部位を記録できます  

![output](https://user-images.githubusercontent.com/81734783/144445451-70356536-4b62-4fd3-9a46-c0da29cc527b.gif)  

テストユーザーの使用例  

![screenshot](https://user-images.githubusercontent.com/81734783/144441499-e1157da7-cc10-4243-8dff-85cab62dfe66.png)  


## 苦労したところ
1. テストの重要性も考慮し、モデルスペック・リクエストスペック・フィーチャスペックを記述しました。**合計67のテストコード**でアプリケーションコードの安全性・保守性を保証しています

2. 運動記録をグラフとして表示するときに、ユーザーがデータを入力していない曜日は「0」というデータを代入する必要があるところに苦労しました。
ここを何も配慮せずにDBから一週間のデータを取ってくると、ユーザーが入力していない曜日はnilとなってしまってグラフが上手く表示できなくなります。
したがってif文を使い、もしユーザーがデータを入力していないところがあれば「0」を記録するというコードを記述しました。


## ER図
![ER図 drawio](https://user-images.githubusercontent.com/81734783/149665339-c8b9526c-d434-4641-9209-d81053f21d30.png)

## インフラ構成図
開発はdocker上で行いました。git pushするとCircleCIが起動し、RSpecとRubocopを使ったテストを実行させるように設定しています。  
またAWSを導入しており、独自ドメインの取得およびhttps化も設定しています。
![インフラ構成図 drawio](https://user-images.githubusercontent.com/81734783/148368850-d7af9b5f-15a6-4dfe-a8a5-d8563f1e75a1.png)

  
## 使用した技術
* サーバーサイド言語：Ruby
* データベース：PostgreSQL
* インフラ：AWS（EC2, RDS, Internet Gateway, Route53, ELB, Certificate Manager ）, Docker&docker-compose, CircleCI
* ソース管理：Git
* フロント：HTML, CSS, JS
* テストフレームワーク：RSpec  


## 使用したgem (一部抜粋)
* chart.js (グラフの描画)
* gon (RailsとJavascriptの連携)
* kaminari (ページネーション)
* rspec-rails (テスト)
* capybara (UIテスト用のフレームワーク)
* factory_bot_rails (テスト用のサンプルデータ作成)
* rubocop (コード解析)
* launchy (デバック)
* pry-rails (デバック)  


## その他
知識のアウトプットの場として、Qiitaに記事を挙げていますので一度ご覧いただけると嬉しいです  
https://qiita.com/i-f
